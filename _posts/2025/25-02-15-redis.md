---
layout  : post
title   : 개발자도 모르는 Redis 100% 활용 가이드
summary : Redis, 잘 쓰려면 이렇게 써야 합니다.
date    : 2025-02-25 18:22:00 +0900
tag     : redis
resource: CE/7B98C2-F86D-46A9-949B-56BAA0135AF6
toc     : true
comment : true
public  : true
---
* TOC
{:toc}

### Redis, 그냥 캐시로만 쓰고 계신가요?

백엔드 성능 최적화의 기본인 Redis, 어떻게 쓰고 계신가요?

제가 현업에서 마주한 개발자들은 대부분 Redis를 토큰 저장, 조회, 캐싱 정도로만 활용하고 있었습니다. 하지만 이건 Redis를 10%만 활용하는 것에 불과합니다. 

저 역시 처음에는 Redis를 단순한 Key-Value 저장소로만 활용했습니다. 그러던중 서비스의 유저가 급격히 늘어나며 트래픽 증가로 인해 서버의 성능이 저하되는 문제가 발생했습니다. 당시 이 문제를 해결하기 위해 깊게 공부하며 Redis의 높은 성능을 알게되었습니다. Redis는 Sorted Set, HyperLogLog, Pub/Sub, Stream과 같은 강력한 기능을 제공하며, 이를 적절히 활용한다면 **훨씬 쉽고 효율적으로 성능을 최적화**할 수 있습니다. 

Redis는 단순한 캐시가 아닌 백엔드 아키텍처를 개선할 수 있는 **개발자의 강력한 도구**지만, 직접 경험하기 전에는 진가를 알기 어렵습니다. 그렇다면 Redis는 어떻게 써야 좋을까요? 

### Redis는 관계형 데이터베이스의 든든한 파트너

관계형 데이터베이스(RDB)는 수십 년간 검증된 백엔드의 주연(Hero) 입니다. 하지만 대규모 트래픽이 발생하는 경우에서 모든 요청과 연산을 RDB에 맡기면 서버 부하를 가중시키고, 응답 속도가 저하되며, 결국 병목 현상이 발생합니다. 

이때 Redis는 데이터베이스의 부담을 덜어주는 조연(Supporter)으로서 중요한 파트너 역할을 합니다.

- 자주 조회되는 데이터를 캐싱해 **DB 부하 감소**
- 세션 관리, 실시간 데이터 처리, 분산 락 등을 활용해 **응답 속도 개선**
- RDB의 한계를 보완하며 **보다 빠르고 안정적인 서비스 운영**

하지만 메모리를 기반으로 동작하는 Redis의 특성상, 무조건적으로 모든 데이터를 저장하는 것은 정답이 아닙니다. 효율적인 활용 전략 없이 사용한다면 오히려 비용 낭비와 성능 문제가 발생하게 됩니다. 그렇다면 많은 개발자들이 Redis를 사용할 때 흔히 마주하는 잘못된 사례는 무엇일까요? 

### 흔히 발생하는 잘못된 Redis 활용 사례

Redis를 제대로 이해하지 않고 사용하면 다음과 같은 문제들이 흔하게 발생할 수 있습니다. 

- **장애 발생시 빠른 복구가 어려움**
    - 보통 Redis의 장애 상황에 대비한 코드가 없고, 이것은 곧 예외에 대한 **예외 마스킹(Exception Masking)**이 되어있지 않다는 것을 의미합니다.
    - 장애 발생시 정상흐름(e.g. RDB 조회, Redis Sentinel)으로 바꿔주는 코드가 없고, 마스킹이 되어있지 않으면 **원인을 찾지 못해 계속해서 복구 시간이 길어지게 됩니다.**
- **Redis의 리소스 사용량 예측 불가**
    - 적절한 리소스 계산 없이 Redis를 운영하면 필요 이상의 큰 인스턴스를 할당해 불필요한 비용이 지불됩니다.
    - 부적절한 TTL 설정으로 인해 캐시 삭제 알고리즘이 동작하지 않아 예기치 못한 오류나 성능 저하가 발생합니다.
- **Redis가 제공하는 고급 기능 활용 불가**
    - Redis는 다양한 문제를 해결하는 기능을 제공합니다. 이를 모르고 다른 기술을 도입한다면 불필요하게 복잡한 로직을 구현하게 됩니다.
    - 예를 들어 내 위치를 기반으로 주변의 맛집을 검색하는 API를 만들 때 RDB를 기반으로 구현한다면 다소 복잡해지고, GeoHash 활용이 까다롭습니다. 이럴 때 Redis에서 제공하는 Geofencing 기능을 알고 있다면 간단하게 위치 기반 서비스를 구현할 수 있죠.

### Redis를 정확히 이해하고 써야 하는 이유

보통은 Redis를 깊게 이해하지 못하고 단순히 SET, GET 커맨드로만 사용하는 경우가 많습니다. 하지만 Redis는 문제 해결을 위한 알고리즘을 만들기에 충분한 **여러 자료구조를 지원**하고 있습니다. Redis를 활용하기 전에 이런 내용을 숙지하고 있다면, 같은 기능이어도 RDB 기반으로 구현할 때보다 훨씬 빠르게 만들 수 있습니다. 또한 불필요한 기술 스택을 추가하는 경우도 방지할 수 있게 되죠. 

**[각 자료구조별 대표적 활용 케이스]**

- String: 일반적인 Key-Value 캐싱 (e.g. 토큰 저장)
- List: FIFO(Queue) 또는 LIFO(Stack) 구조 활용 (e.g. 메시지 큐)
- Set: 중복 없는 데이터 저장 (e.g. 실시간 접속 유저 목록)
- Sorted Set: 순위 기반 데이터 저장 (e.g. 랭킹보드)
- HyperLogLog: 대량의 고유 값 개수 추정 (e.g. DAU 계산)
- Bitmaps: 특정 값의 On/Off 저장 (e.g. 유저 출석체크)
- Geo: 위치 기반 데이터 처리 (e.g. 반경 내 맛집 검색)

### Redis를 깊이 있게 공부하는 법

Redis, 이제 정확히 이해하고 활용해야겠다는 마음이 드셨나요? 그렇다면 어떻게 공부해야 Redis를 100% 활용하는데 도움이 될까요? 다음과 같은 방법을 추천합니다. 

- **공식 문서 숙지**
    - 모든 기술은 공식 문서에 정답이 있습니다. Redis의 권장 사용법과 최신 기능을 알 수 있고, 잘못된 사용을 방지합니다.
- **성능 테스트 진행**
    - Ngrinder, Jmeter, K6와 같은 테스트 툴을 활용해 Redis 활용 전후의 성능을 분석하고, 최적화하는 방법을 찾아봅니다. 실제로 Redis 활용시 가정과 다른 테스트 결과가 나올 수 있습니다. 그렇기에 단순 가정으로만 코드를 구현해보는 것이 아닌, 테스트를 통해 검증하는 과정이 중요합니다. 회사에서 내 의견을 주장할 때, 실질적 수치와 함께 검증 기반으로 설득하는 것이 가장 좋습니다.
- **예외 상황 만들기**
    - 여러가지 예외상황에 대처하며 LRU 캐싱, 분산 락, Rate Limiter 등의 Redis 활용 패턴을 어떤 상황에 어떻게 적용해야 하는지 배울 수 있습니다. 예외를 경험하다보면 실제 서비스에서 해당 상황이 발생했을 때 적절하게 대처할 수 있겠죠.
        - 예시1. 서버를 구동하고 중간에 Redis를 꺼버린다면 어떤 상황이 발생할지 인위적으로 환경을 만들어보세요.
        - 예시2. 굉장히 부하가 많은 커맨드의 연산으로 로직을 구성해서 Redis에 부하를 가한다면 어떤 상황이 발생하는지 알아보세요.
- **실전 프로젝트 적용**
    - Redis가 제공하는 다양한 자료구조를 활용해 직접 프로젝트에 적용해 봅니다. 예를 들어 Sorted Set을 이용해 랭킹 시스템을 구현하거나 HyperLogLog를 통해 효율적인 유니크카운팅을 해볼 수 있습니다.
    - 이런 경험을 통해 새롭게 서비스하거나, 기존 서비스를 개선하기 위해 적용할 수 있는 다양한 케이스들을 배울 수 있습니다.
- **코드리뷰 받기**
    - Redis는 잘못 사용하기 쉬운 기술입니다. 그렇기 때문에 실무적인 관점에서 기능을 적절히 사용하고 있는지 시니어 개발자로부터 코드리뷰를 받는 것이 중요합니다.
